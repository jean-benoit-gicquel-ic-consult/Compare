<WebDesigner>
  <Context ID="VI_Common_ExternalFormHost" MetamodelVersion="2016-05-08" MigrationNotes="DMLREPLACE;" HelpChapterUid="" AllowUrlNavigation="true" ScriptItemUID="Context1">
    <ContextConfiguration>
      <CompilationSettings ScriptItemUID="CompilationSettings1" />
      <ContextParameters ScriptItemUID="ContextParameters1">
        <Parameter Name="URL" Comment="For security reasons, this parameter cannot have an arbitrary URL. The value can be either:&#xD;&#xA;- a UID of a RelatedApplication&#xD;&#xA;- &quot;QPM1&quot;, &quot;QPM2&quot; or &quot;QPM3&quot;&#xD;&#xA;&#xD;&#xA;If you need the ability to pass arbitrary URLs, do not this module. Use the QBM_Common_ExternalFormHost form component instead." />
        <Parameter Name="DisplayName" />
        <Parameter Name="HeadingName" IsMandatory="false" />
      </ContextParameters>
    </ContextConfiguration>
    <Tables ScriptItemUID="Tables1" />
    <Controls ScriptItemUID="Controls1" />
    <Functions ScriptItemUID="Functions1">
      <Function ScriptItemUID="Function1" Name="GetTargetUrl(string input)" DataType="System.String" Expression="{{&#xD;&#xA;string url = null;&#xD;&#xA;var relatedApp = _UserSession.SessionModule.TableStore.GetTable(&quot;UserRelatedApplication&quot;).GetRowForPrimaryKey(input);&#xD;&#xA;if (relatedApp != null)&#xD;&#xA;   url = relatedApp.GetValue(&quot;URL&quot;).String;&#xD;&#xA;&#xD;&#xA;if (input == &quot;QPM1&quot;)&#xD;&#xA;   url = GetQPM1();&#xD;&#xA;else if (input == &quot;QPM2&quot;)&#xD;&#xA;   url = GetQPM2();&#xD;&#xA;else if (input == &quot;QPM3&quot;)&#xD;&#xA;   url = GetQPM3();&#xD;&#xA;   &#xD;&#xA;if (url == null)&#xD;&#xA;   Logger.Info(&quot;Ignoring unknown URL input: &quot;+input);&#xD;&#xA;   &#xD;&#xA;VI.WebRuntime.RuntimeUtil.CheckIsValidUrlForRedirect(url);&#xD;&#xA;@return url;&#xD;&#xA;}}" />
      <Function ScriptItemUID="Function2" Name="GetQPM1()" DataType="System.String" Expression="if isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_Version&quot;), &quot;true&quot;)=&quot;true&quot;&#xD;&#xA;then&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/EntryPoint/?ActionName=ChangePassword&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;Integrated=Yes&quot;,&#xD;&#xA;	from User select CentralAccount,	&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal\BaseURL'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)&#xD;&#xA;)&#xD;&#xA;else&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/user/EntryPoint?ActionName=ChangePassword&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;PortalHomePage={2}&amp;GUILayout=Integrated&quot;,&#xD;&#xA;	from User select CentralAccount,&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)&#xD;&#xA;)" />
      <Function ScriptItemUID="Function3" Name="GetQPM2()" DataType="System.String" Expression="if isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_Version&quot;), &quot;true&quot;)=&quot;true&quot;&#xD;&#xA;then&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/EntryPoint/?ActionName=SetQAProfile&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;Integrated=Yes&quot;,&#xD;&#xA;	from User select CentralAccount,&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal\BaseURL'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)		&#xD;&#xA;)&#xD;&#xA;else&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/user/EntryPoint?ActionName=SetQAProfile&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;PortalHomePage={2}&amp;GUILayout=Integrated&quot;,&#xD;&#xA;	from User select CentralAccount,&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)&#xD;&#xA;)" />
      <Function ScriptItemUID="Function4" Name="GetQPM3()" DataType="System.String" Expression="if isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_Version&quot;), &quot;true&quot;)=&quot;true&quot;&#xD;&#xA;then&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/EntryPoint/?ActionName=ChangeSettings&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;Integrated=Yes&quot;,&#xD;&#xA;	from User select CentralAccount,&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal\BaseURL'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)&#xD;&#xA;)&#xD;&#xA;else&#xD;&#xA;(&#xD;&#xA;Format(&quot;{4}/user/EntryPoint?ActionName=ChangeSettings&amp;IdentificationDomain={3}&amp;IdentificationAccount={0}&amp;CurrentLanguage={1}&amp;PortalHomePage={2}&amp;GUILayout=Integrated&quot;,&#xD;&#xA;	from User select CentralAccount,&#xD;&#xA;	getCulture(),&#xD;&#xA;	urlencode(isnull(getconfig(&quot;VI_MyData_MyPassword_QPM_PortalLink&quot;), GetConfigParm('QER\WebPortal'))),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_IdentificationDomain&quot;),&#xD;&#xA;	getconfig(&quot;VI_MyData_MyPassword_QPM_BaseURL&quot;),&#xD;&#xA;	)&#xD;&#xA;)" />
      <Function ScriptItemUID="Function5" Name="getCulture()" DataType="System.String" Expression="if ( ( 1 &lt; IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) ) &#xD;&#xA; AND ( 1 &lt; IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;-&quot;,IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) ) ) )&#xD;&#xA;        then Substring ( from user select DisplayValue( UID_DialogCulture ), &#xD;&#xA;		                 IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) + 1,  &#xD;&#xA;						 IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;-&quot;,IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) ) &#xD;&#xA;						 -IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) - 1 )&#xD;&#xA;else if ( ( 1 &lt; IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) ) &#xD;&#xA;	  AND ( 1 &lt; IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;]&quot;,0 ) ) )&#xD;&#xA;      then  Substring ( from user select DisplayValue( UID_DialogCulture ), &#xD;&#xA;	                    IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) + 1,  &#xD;&#xA;						IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;]&quot;,0 ) &#xD;&#xA;						-IndexOf( from user select DisplayValue( UID_DialogCulture ),&quot;[&quot;,0 ) - 1 )&#xD;&#xA;else if (1 &lt; indexof(variable(&quot;%currentculture%&quot;), &quot;-&quot;, 0))&#xD;&#xA;      then (substring(variable(&quot;%currentculture%&quot;), 0, indexof(variable(&quot;%currentculture%&quot;), &quot;-&quot;, 0)))&#xD;&#xA;else &quot;en&quot;" />
    </Functions>
    <DataEventHandlers ScriptItemUID="DataEventHandlers1" />
    <ActionSequence ScriptItemUID="Action1" />
    <Forms ScriptItemUID="Forms1">
      <Form ID="Form" NavigationTitle="isnullorempty(request(&quot;HeadingName&quot;),request(&quot;DisplayName&quot;))" ScriptItemUID="Form1">
        <ActionSequence ScriptItemUID="Action2" />
        <PagePartContainer ID="Main" ScriptItemUID="PagePartContainer1">
          <Container EnableCustomAttributes="true" ScriptItemUID="Container1">
            <HtmlAttributes>
              <HtmlAttribute Name="'style'" ScriptItemUID="style" Value="'position: absolute; left: 0; right: 0; top: 0; bottom: 0;'" />
            </HtmlAttributes>
            <IFrame URL="GetTargetUrl(request(&quot;URL&quot;))" IsAutoSize="true" ScriptItemUID="IFrame1" />
          </Container>
        </PagePartContainer>
      </Form>
    </Forms>
  </Context>
</WebDesigner>
